---
name: coworking-with-claude
description: Enables Claude to work alongside users on Windows desktop applications. Automates PowerPoint, Word, and Excel through programmatic APIs and GUI interaction. Use for "클로드 코워크", "파워포인트 자동화", "워드 문서", "엑셀 자동화", "Claude cowork", "office automation" requests.
trigger-keywords: claude cowork, cowork, 클로드 코워크, powerpoint, word, excel, office, 파워포인트, 워드, 엑셀, pptx, docx, xlsx
allowed-tools: Read, Write, Edit, Bash, Grep, Glob
priority: medium
tags: [integration, windows, office, automation, claude-cowork]
---

# Claude Cowork - Windows Office Automation

Work alongside Claude to create, edit, and automate Microsoft Office documents on Windows.

## Overview

**핵심 기능:**
- PowerPoint presentation creation and editing (slides, charts, animations)
- Word document generation with styles, tables, and formatting
- Excel spreadsheet automation (formulas, pivot tables, charts)
- GUI-level interaction via computer use for complex Office operations
- Template-based batch document generation

## When to Use

**명시적 요청:**
- "파워포인트 만들어줘", "프레젠테이션 생성"
- "워드 보고서 작성해줘", "문서 자동화"
- "엑셀 데이터 정리해줘", "차트 만들어줘"
- "Claude cowork", "Office automation"

**자동 활성화:**
- Working with .pptx, .docx, .xlsx files
- Presentation or report generation tasks
- Data analysis requiring Excel output

## Prerequisites

### Dependencies

```bash
pip install python-pptx python-docx openpyxl pandas
# For GUI automation (Windows)
pip install pywinauto pyautogui
```

## Quick Reference

### PowerPoint - Create Presentation

```python
from pptx import Presentation
from pptx.util import Inches, Pt
from pptx.enum.text import PP_ALIGN

prs = Presentation()

# Title slide
slide = prs.slides.add_slide(prs.slide_layouts[0])
slide.shapes.title.text = "Project Report"
slide.placeholders[1].text = "Generated by Claude Cowork"

# Content slide with bullet points
slide = prs.slides.add_slide(prs.slide_layouts[1])
slide.shapes.title.text = "Key Findings"
body = slide.placeholders[1]
tf = body.text_frame
tf.text = "Finding 1: Performance improved 30%"
p = tf.add_paragraph()
p.text = "Finding 2: Cost reduced by 15%"
p.level = 0

prs.save("report.pptx")
```

### PowerPoint - Add Chart

```python
from pptx.chart.data import CategoryChartData
from pptx.enum.chart import XL_CHART_TYPE

chart_data = CategoryChartData()
chart_data.categories = ["Q1", "Q2", "Q3", "Q4"]
chart_data.add_series("Revenue", (120, 150, 180, 210))
chart_data.add_series("Costs", (80, 90, 95, 100))

slide = prs.slides.add_slide(prs.slide_layouts[5])
chart = slide.shapes.add_chart(
    XL_CHART_TYPE.COLUMN_CLUSTERED,
    Inches(1), Inches(1.5), Inches(8), Inches(5),
    chart_data
).chart
chart.has_legend = True
```

### Word - Create Document

```python
from docx import Document
from docx.shared import Pt, Inches
from docx.enum.text import WD_ALIGN_PARAGRAPH

doc = Document()

# Title
doc.add_heading("Monthly Report", level=0)
doc.add_paragraph("Generated automatically by Claude Cowork")

# Styled paragraphs
p = doc.add_paragraph()
run = p.add_run("Key Highlights")
run.bold = True
run.font.size = Pt(14)

# Table
table = doc.add_table(rows=3, cols=3, style="Light Grid Accent 1")
table.cell(0, 0).text = "Metric"
table.cell(0, 1).text = "Target"
table.cell(0, 2).text = "Actual"
table.cell(1, 0).text = "Revenue"
table.cell(1, 1).text = "$100K"
table.cell(1, 2).text = "$120K"

doc.save("report.docx")
```

### Word - Template-based Generation

```python
from docx import Document

def fill_template(template_path: str, replacements: dict, output_path: str):
    doc = Document(template_path)
    for paragraph in doc.paragraphs:
        for key, value in replacements.items():
            if key in paragraph.text:
                for run in paragraph.runs:
                    run.text = run.text.replace(key, value)
    doc.save(output_path)

fill_template("template.docx", {
    "{{name}}": "John Doe",
    "{{date}}": "2025-02-25",
    "{{department}}": "Engineering",
}, "output.docx")
```

### Excel - Create Spreadsheet with Charts

```python
import openpyxl
from openpyxl.chart import BarChart, Reference

wb = openpyxl.Workbook()
ws = wb.active
ws.title = "Sales Data"

# Add data
headers = ["Month", "Revenue", "Expenses", "Profit"]
data = [
    ["Jan", 10000, 7000, 3000],
    ["Feb", 12000, 7500, 4500],
    ["Mar", 15000, 8000, 7000],
]

ws.append(headers)
for row in data:
    ws.append(row)

# Add formulas
ws["E1"] = "Margin"
for i in range(2, len(data) + 2):
    ws[f"E{i}"] = f"=D{i}/B{i}*100"

# Add chart
chart = BarChart()
chart.title = "Monthly Revenue vs Expenses"
chart.y_axis.title = "Amount ($)"
cats = Reference(ws, min_col=1, min_row=2, max_row=len(data) + 1)
vals = Reference(ws, min_col=2, max_col=3, min_row=1, max_row=len(data) + 1)
chart.add_data(vals, titles_from_data=True)
chart.set_categories(cats)
ws.add_chart(chart, "G2")

wb.save("sales_report.xlsx")
```

### Excel - Pandas Integration

```python
import pandas as pd

# Read, transform, write back
df = pd.read_excel("data.xlsx", sheet_name="Sheet1")
summary = df.groupby("category").agg({"amount": ["sum", "mean", "count"]})

with pd.ExcelWriter("output.xlsx", engine="openpyxl") as writer:
    df.to_excel(writer, sheet_name="Raw Data", index=False)
    summary.to_excel(writer, sheet_name="Summary")
```

## Workflows

### Workflow 1: Presentation from Data

1. Read data source (CSV, Excel, database)
2. Analyze and summarize key metrics
3. Generate slides with charts and insights
4. Apply consistent styling and branding
5. Save and optionally open in PowerPoint

### Workflow 2: Report Generation Pipeline

1. Gather data from multiple sources
2. Process and validate data
3. Generate Word document with tables, charts, and narrative
4. Create accompanying Excel workbook with raw data
5. Generate PowerPoint summary presentation

### Workflow 3: GUI Automation (Windows)

```python
# Using pywinauto for complex Office operations
from pywinauto import Application

# Open existing PowerPoint
app = Application(backend="uia").start("powerpnt.exe")
# Or connect to running instance
app = Application(backend="uia").connect(title_re=".*PowerPoint.*")

# Interact with ribbon, menus, etc.
main_window = app.window(title_re=".*PowerPoint.*")
main_window.menu_select("File->Save As")
```

### Workflow 4: Batch Document Generation

```python
import pandas as pd
from docx import Document

# Generate personalized documents from a data source
contacts = pd.read_csv("contacts.csv")
template = Document("letter_template.docx")

for _, row in contacts.iterrows():
    doc = Document("letter_template.docx")
    for para in doc.paragraphs:
        for key in ["name", "company", "address"]:
            placeholder = "{{" + key + "}}"
            if placeholder in para.text:
                for run in para.runs:
                    run.text = run.text.replace(placeholder, str(row[key]))
    doc.save(f"letters/letter_{row['name']}.docx")
```

## Computer Use Integration

Claude's computer use capability enables direct GUI interaction with Office applications when programmatic APIs are insufficient:

| Scenario | Approach |
|----------|----------|
| Simple document creation | Programmatic API (python-pptx, python-docx, openpyxl) |
| Complex formatting | Programmatic API + GUI for fine-tuning |
| Macro execution | GUI automation (pywinauto) |
| Add-in interaction | GUI automation |
| Visual verification | Computer use screenshot + validation |

## Best Practices

**DO:**
- Use programmatic APIs (python-pptx, python-docx, openpyxl) for reproducible operations
- Save templates for consistent branding
- Process data with pandas before writing to Excel
- Use absolute paths on Windows (`C:\\Users\\...`)
- Close file handles before opening in Office apps

**DON'T:**
- Modify files that are open in Office (use save-as or close first)
- Rely solely on GUI automation when APIs are available
- Hardcode column widths — use auto-fit or relative sizing
- Forget to handle encoding (especially Korean text in Office)
- Skip validation of generated documents

## Troubleshooting

### 문제 1: 한글 텍스트가 깨짐
```python
# Ensure UTF-8 encoding for Korean text
import locale
locale.setlocale(locale.LC_ALL, 'ko_KR.UTF-8')
```

### 문제 2: Excel 파일이 열려 있을 때 수정 불가
```python
# Check and close file handle before modifying
import psutil
for proc in psutil.process_iter(['pid', 'name', 'open_files']):
    if proc.info['name'] and 'EXCEL' in proc.info['name'].upper():
        print(f"Excel PID: {proc.info['pid']}")
```

### 문제 3: PowerPoint 슬라이드 레이아웃 문제
- Use `prs.slide_layouts` to inspect available layouts
- Layouts vary by template — always check `layout.name` before using

## Resources

- [python-pptx docs](https://python-pptx.readthedocs.io/)
- [python-docx docs](https://python-docx.readthedocs.io/)
- [openpyxl docs](https://openpyxl.readthedocs.io/)
- [pywinauto docs](https://pywinauto.readthedocs.io/)
